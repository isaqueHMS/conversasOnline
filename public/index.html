<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mini-Term (Multiplayer)</title>
  
  <!-- Estilos CSS -->
  <link rel="stylesheet" href="style.css?v=9">
  
  <!-- DependÃªncias do Socket.io e SimplePeer -->
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://unpkg.com/simple-peer@9.11.1/simplepeer.min.js"></script>
</head>
<body>

  <!-- ================= LADO ESQUERDO: CHAT PÃšBLICO ================= -->
  <div id="app">
    <h3>ğŸ“¡ Terminal PÃºblico</h3>
    
    <!-- Toolbar -->
    <div id="toolbar">
      <input id="roomInput" type="text" placeholder="Nome da sala">
      <button id="joinBtn">Entrar</button>
      <input id="nameInput" type="text" placeholder="Seu apelido">
      <button id="saveNameBtn">Salvar</button>
    </div>

    <!-- Ãrea do Chat -->
    <div id="chatsContainer">
      <div id="terminal" class="chatBox"></div>
      
      <!-- Indicador de DigitaÃ§Ã£o -->
      <div id="typingIndicator" style="font-size:0.8em; color:#999; padding:0 10px; min-height:15px;"></div>

      <!-- Controles -->
      <div id="controls">
        <input id="cmdInput" type="text" placeholder="Digite sua mensagem..." autocomplete="off">
        <button id="sendBtn">Enviar</button>
      </div>
    </div>

    <!-- Barra de MÃ­dia -->
    <div id="mediaBar">
      <button id="imgBtn">ğŸ“· Imagem</button>
      <button id="audioBtn">ğŸ¤ Ãudio</button>
      <button id="videoBtn">ğŸ¥ VÃ­deo</button>
      
      <input type="file" id="imageInput" accept="image/*" hidden>
      <input type="file" id="audioInput" accept="audio/*" hidden>
      <input type="file" id="videoInput" accept="video/*" hidden>
    </div>

    <!-- Barra de Progresso (Opcional) -->
    <div id="progressWrapper" style="display:none;">
      <div id="progressBar"></div>
    </div>
  </div>

  <!-- ================= LADO DIREITO: SISTEMA DE CLÃƒS ================= -->
  <div id="clansScreen">
    
    <!-- Menu de NavegaÃ§Ã£o -->
    <div class="clan-tabs">
      <button class="tab-btn active" onclick="openTab('tab-home')">ğŸ  InÃ­cio</button>
      <button class="tab-btn" onclick="openTab('tab-members')">ğŸ‘¥ Membros</button>
      <button class="tab-btn" onclick="openTab('tab-admin')">âš™ï¸ GestÃ£o</button>
      <button class="tab-btn" onclick="openTab('tab-rank')">ğŸ† Ranking</button>
    </div>

    <!-- 1. INÃCIO -->
    <div id="tab-home" class="tab-content active">
      <div class="scroll-area">
        <h4>Meu Status</h4>
        <div id="clanInfo" class="info-box">Carregando...</div>
        
        <div class="group-box">
          <label>AÃ§Ãµes</label>
          <div class="input-row"><input id="clanInput" type="text" placeholder="Nome do ClÃ£..."></div>
          <div class="btn-row">
            <button id="createClanBtn" class="btn-green">Criar</button>
            <button id="leaveClanBtn" class="btn-red">Sair</button>
          </div>
          <button id="listClansBtn" style="width:100%; margin-top:5px;">Ver Lista</button>
        </div>
        
        <div class="group-box">
          <label>Convites</label>
          <div class="btn-row">
            <button id="acceptInviteBtn" class="btn-green">Aceitar</button>
            <button id="declineInviteBtn" class="btn-red">Recusar</button>
          </div>
        </div>

        <!-- PAINEL DE VOZ -->
        <div class="group-box" style="border-color: #8b5cf6;">
          <h4 style="color: #8b5cf6;">ğŸ”Š Canal de Voz</h4>
          
          <div id="voiceControls">
              <button id="joinVoiceBtn" class="btn-green" style="width: 100%;">Entrar na Voz</button>
              <button id="leaveVoiceBtn" class="btn-red" style="display:none; width: 100%;">Sair da Voz</button>
          </div>

          <div id="voiceStatus" style="margin-top:5px; font-size:0.8em; color:#aaa; text-align: center;">
              Desconectado
          </div>

          <!-- Grade de UsuÃ¡rios na Voz -->
          <div id="audioContainer" class="voice-grid"></div>
        </div>
      </div>
    </div>

    <!-- 2. MEMBROS -->
    <div id="tab-members" class="tab-content">
      <h4>Membros</h4>
      <div id="membersListDiv" class="scroll-area">
        <div class="info-box">...</div>
      </div>
    </div>

    <!-- 3. GESTÃƒO -->
    <div id="tab-admin" class="tab-content">
      <div class="scroll-area">
        
        <!-- ADMIN BÃSICO -->
        <div class="group-box">
          <h4>ğŸ‘® Hierarquia</h4>
          <div class="input-row">
             <input id="inviteTargetInput" type="text" placeholder="Convidar usuÃ¡rio">
             <button id="inviteBtn">Env</button>
          </div>
          <hr class="separator">
          <input id="promoteTargetInput" type="text" placeholder="Nome do Alvo">
          <div class="btn-row" style="margin-top:5px;">
            <button id="promoteBtn" class="btn-blue">Promover â–²</button>
            <button id="demoteBtn" class="btn-red">Rebaixar â–¼</button>
          </div>
        </div>

        <!-- ZONA DO DONO -->
        <div class="group-box" style="border-color: #f59e0b;">
          <h4 style="color:#f59e0b">ğŸ‘‘ Zona do Dono</h4>
          <input id="ownerTargetInput" type="text" placeholder="Alvo (Expulsar/Ban/Mute)">
          <div class="btn-row" style="margin-top:5px;">
             <button id="kickBtn" class="btn-red">Expulsar</button>
             <button id="banBtn" style="background:#450a0a; border-color:red;">BANIR ğŸš«</button>
          </div>
          <button id="muteBtn" style="width:100%; margin-top:5px; background:#4b5563;">Silenciar/Desmutar ğŸ”‡</button>
          
          <hr class="separator" style="border-color: #ef4444; opacity: 0.8;">
          
          <button id="dissolveBtn" class="btn-attack" style="background: red; color: white; font-weight: 900;">
            âš ï¸ DISSOLVER CLÃƒ
          </button>
        </div>

        <!-- GUERRA (MINIGAME HACKING) -->
        <div class="group-box war-zone" id="warZonePanel">
          <h4 style="color: #ef4444;">âš”ï¸ Cyber Warfare</h4>
          
          <!-- ConfiguraÃ§Ã£o -->
          <div id="warConfigArea">
            <input id="warTargetInput" type="text" placeholder="Nome do ClÃ£ Inimigo">
            <button id="createWarBtn" class="btn-danger" style="width:100%; margin-top:5px;">DECLARAR GUERRA (60s)</button>
          </div>

          <hr class="separator">

          <!-- Ãrea do Jogo -->
          <div id="warGameArea" style="display:none; text-align:center;">
            
            <div style="display:flex; justify-content:space-between; margin-bottom:5px; font-size:0.8rem;">
              <span id="myClanScore" style="color:cyan">NÃ³s: 0</span>
              <span style="color:#666">VS</span>
              <span id="enemyClanScore" style="color:red">Eles: 0</span>
            </div>

            <!-- Barra de Vida -->
            <div class="war-progress-bg">
              <div id="warProgressBar" class="war-progress-fill"></div>
            </div>

            <!-- Terminal de Hack -->
            <div class="hack-terminal">
              <div class="hack-screen">
                <p>COMANDO DE ATAQUE:</p>
                <h2 id="hackCodeDisplay">---</h2>
              </div>
              
              <input id="hackInput" type="text" placeholder="Digite o cÃ³digo..." autocomplete="off">
              <div id="hackFeedback" style="height:20px; font-size:0.8rem; margin-top:5px;"></div>
            </div>
            
            <!-- Elementos Ocultos (Compatibilidade) -->
            <select id="warSelect" style="display:none;"></select>
            <button id="submitPointBtn" style="display:none;"></button>
          </div>
          
          <div id="noWarMsg" style="text-align:center; padding:10px; color:#555;">
            Nenhuma guerra ativa.
          </div>
        </div>

      </div>
    </div>

    <!-- 4. RANKING -->
    <div id="tab-rank" class="tab-content">
      <h4>Top ClÃ£s</h4>
      <button id="requestRankingBtn" style="width:100%;">Atualizar</button>
      <div id="rankingDiv" class="ranking-list"></div>
    </div>

    <!-- RODAPÃ‰ CHAT -->
    <div class="clan-chat-footer">
      <h4>ğŸ’¬ Chat</h4>
      <div id="clanChatDiv" class="chatBox small-chat"></div>
      <div class="chat-input-area">
        <input id="clanChatInput" type="text" placeholder="Msg...">
        <button id="clanChatSendBtn">Env</button>
      </div>
    </div>
  </div>

  <!-- MODAL DE PREVIEW -->
  <div id="imagePreviewModal" style="display:none;">
    <img id="previewImage" src="">
  </div>
  
  <!-- OVERLAY DE ARRASTAR E SOLTAR -->
  <div id="dragOverlay">
    <div class="drag-content">
      <h1>ğŸ“‚ Solte o arquivo aqui</h1>
      <p>Para enviar para o chat</p>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script>
    function openTab(id) {
      // Esconde todos os conteÃºdos
      Array.from(document.getElementsByClassName("tab-content")).forEach(e => e.style.display = "none");
      
      // Reseta botÃµes
      Array.from(document.getElementsByClassName("tab-btn")).forEach(e => e.classList.remove("active"));
      
      // Mostra o selecionado
      const selected = document.getElementById(id);
      if(selected) selected.style.display = "flex";
      
      // Ativa o botÃ£o correspondente
      const btns = document.getElementsByClassName("tab-btn");
      if(id.includes("home")) btns[0].classList.add("active");
      if(id.includes("members")) btns[1].classList.add("active");
      if(id.includes("admin")) btns[2].classList.add("active");
      if(id.includes("rank")) btns[3].classList.add("active");
    }
  </script>
  
  <script src="client.js"></script>
</body>
</html>